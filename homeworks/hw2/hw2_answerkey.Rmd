```{r message = FALSE}
# include = FALSE prevents code and results from appearing in the finished file. R Markdown still runs the code in the chunk, and the results can be used by other chunks.
# echo = FALSE prevents code, but not the results from appearing in the finished file. This is a useful way to embed figures.
# message = FALSE prevents messages that are generated by code from appearing in the finished file.
# warning = FALSEprevents warnings that are generated by code from appearing in the finished.
library(data.table)
library(readr)
library(readxl)
library(tidyverse)
```

---
title: "Empirical Exercise 2 Answer Key"
author: Eugene Tan
output: html_notebook
---

This problem set is due on October 26. I strongly recommend to start working on the homework early. You can work in pairs and submit a common solution. Please submit the homework as an R markdown file (if there are data files, they put all the files in a zip file). The code must run without errors. To make this easier, set the working directory at the beginning so it can be easily changed by someone else running the code.

For this exercise you will use a dataset collected by S&P Global. Choose one of the datasets available, which have data for either 2009 or 2018 for one of the following ISOs: MISO, PJM, ERCOT, or New England ISO. The goal of the exercise is to build the supply curve for a wholesale electricity market and to analyze how costs determine the composition of fuels and emissions. We will also use the exercise to see how things would change with a carbon tax.

*Eugene

## Select the following variables from your dataset: 
* Plant Unit key
* Primary fuel type
* Generation technology
* Summer capacity MW
* Variable O&M cost per MWh (this is the variable cost)
* Total fuel cost per MWh (this is part of the variable cost) 
* Emission allowances costs (this is part of the variable cost) 
* Fixed O&M cost
* Heat rate btu/ kwh
* Heat input (MMBTU)
* Net generation MWh
* Capacity factor
* NOX Emissions Rate (lbs/MMBtu)
* SO2 Emissions Rate (lbs/MMBtu)
* CO2 Emissions Rate (lbs/MMBtu)

```{r echo = TRUE, warning = FALSE}
ercot2018 <- fread("data/ercot2018.csv")
ercot2009 <- fread("data/ERCOT_2009.csv")
ne2009 <- read_excel("data/ISO_NE_2009.xls", 
         col_types = c("text", "numeric", "numeric", 
         "text", "text", "text", "text", "numeric", 
         "numeric", "numeric", "numeric", 
         "numeric", "numeric", "numeric", 
         "numeric", "numeric", "numeric", 
         "numeric", "numeric", "numeric", 
         "numeric", "numeric", "numeric", 
         "numeric", "text", "text", "text", 
         "text", "text", "text", "text", "text", 
         "text", "text"))
ne2009 <- as.data.table(ne2009)
miso2018 <- fread("data/MISO2018.csv")
ne2018 <- fread("data/NEISO_2018.csv")
ny2018 <- fread("data/NYISO_2018.csv") 
pjm2009 <- fread("data/PJM2009.csv", skip = 31)
alldata <- list(ercot2018, ercot2009,ne2009,miso2018,ne2018,ny2018, pjm2009)

# Get a unique list of all the column names
allcols <- unique(unlist(sapply(alldata, names)))
# Map each of these to the variable name I want
c('name','pkey','pukey','unitno','fueltype','tech','operating','capacity','capacity_adj','capacity_cum','vcost_om',
  'vcost_fuel','vcost_om2','vcost_om3','vcost_emissions','fcost','tcost_om','heat_rate','heat_input','net_generation','cap_factor','nox','sox','co2','cogen','gscfuelsrc','gsc_

```



















